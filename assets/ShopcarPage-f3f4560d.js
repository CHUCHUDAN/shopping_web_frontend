import{b as y,c as P,x,e as s,l as H,t as l,f as C,j as v,F as b,k as A,u as F,o as S,d as _}from"./index-3580c150.js";import{_ as T,u as w,t as k,b as m,a as B,H as M,A as q,B as $,F as L}from"./FooterComponent-b2d2cabc.js";import{p as D}from"./product-d27d2569.js";const j={class:"data-wrapper"},N=["onClick"],O={class:"product-data"},V={class:"product-price"},Q={class:"product-num"},z={class:"userData-wrapper"},G={class:"product-name"},I={class:"product-name"},R={class:"shopcar-num"},J={class:"shopcar-price"},K={class:"use-wrapper"},U={class:"control-button"},W=["onClick"],X=["onClick"],Y={class:"delete-button"},Z=["onClick"],ss={__name:"ShopcarProduct",setup(E){const i=D(),c=w(),a=async p=>{window.scrollTo({top:0,behavior:"smooth"});const h=k.putTokenToHeader(),t=await m.DELETE(`/api/v1/shopcars/${p}`,void 0,h),{success:o,message:e}=t.data;return o?(i.deleteProducts(p),i.totalAmountCount(),c.setSuccess(e)):c.setError(e)},f=p=>{A.push(`/product/${p}`)};return(p,h)=>(y(!0),P(b,null,x(v(i).products,t=>{var o,e,n,r,u,d;return y(),P("div",{class:"product-wrapper",key:t.id},[s("div",j,[s("div",{class:"product-pic",style:H(`background-image: url('${(o=t.Product)==null?void 0:o.avatar}')`),onClick:g=>f(t.product_id)},null,12,N),s("div",O,[s("div",V,"售價: $ "+l((e=t.Product)==null?void 0:e.price),1),s("div",Q,"存貨量: "+l((n=t.Product)==null?void 0:n.inventory_quantity),1)])]),s("div",z,[s("div",G,"商品名稱: "+l((r=t.Product)==null?void 0:r.name),1),s("div",I,"商品分類: "+l((u=t.Product)==null?void 0:u.Category.name),1),s("div",R,[C("購買數量: "),s("span",null,l(t.quantity),1)]),s("div",J,[C("累加金額: "),s("span",null,"$ "+l(t.quantity*((d=t.Product)==null?void 0:d.price)),1)])]),s("div",K,[s("div",U,[s("i",{class:"fa-solid fa-circle-plus plus",onClick:g=>v(i).setProductQuantity("plus",t.id)},null,8,W),s("i",{class:"fa-solid fa-circle-minus minus",onClick:g=>v(i).setProductQuantity("minus",t.id)},null,8,X)]),s("div",Y,[s("i",{class:"fa-solid fa-trash delete","product-id":"item.product_id",onClick:g=>a(t.product_id)},null,8,Z)])])])}),128))}},ts=T(ss,[["__scopeId","data-v-1888eca6"]]);const os={class:"shopcar-wrapper"},es={class:"checkout-wrapper"},cs={class:"total-amount"},as={class:"checkout-button"},rs={class:"updated-button"},ns={class:"products-wrapper"},us={__name:"ShopcarPage",setup(E){const i=F(),c=w(),a=D(),f=B();c.clearErrorMessages(),c.clearSuccessMessages(),S(()=>{if(f.user.role!=="buyer")return i.push("/")}),S(async()=>{const t=k.putTokenToHeader(),o=await m.GET("/api/v1/shopcars",void 0,t),{success:e,message:n,data:r}=o.data;return e?(a.totalAmount=r.totalAmount,a.setProduct(r.shopcars)):c.setError(n)});const p=async()=>{const t=a.products,o=Object.fromEntries(t.map(d=>[d.product_id,d.quantity])),e=k.putTokenToHeader(),n=await m.PATCH("/api/v1/shopcars",o,e),{success:r,message:u}=n.data;return r?c.setSuccess(u):c.setError(u)},h=async()=>{const t=a.products,o=Object.fromEntries(t.map(d=>[d.product_id,d.quantity])),e=k.putTokenToHeader(),n=await m.POST("/api/v1/shopcars/checkout",o,e),{success:r,message:u}=n.data;return r?(a.productCheckout(),a.totalAmount=0,c.setSuccess(u)):c.setError(u)};return(t,o)=>(y(),P(b,null,[_(M),s("div",os,[_(q),s("div",es,[s("div",cs,"總金額: "+l(v(a).totalAmount),1),s("div",as,[_($,{msg:"結帳",backgroundColor:"background-color:#FFBD9D",onClick:h})]),s("div",rs,[_($,{msg:"更新",backgroundColor:"background-color:#FFBD9D",onClick:p})])]),s("div",ns,[_(ts)])]),_(L)],64))}},ls=T(us,[["__scopeId","data-v-df19441e"]]);export{ls as default};
