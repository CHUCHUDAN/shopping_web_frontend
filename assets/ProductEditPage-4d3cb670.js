import{s as q,u as I,r as R,o as v,b as _,c as g,d as r,e as a,w as B,n as M,j as n,t as h,F as S,x as D,p as H,h as T}from"./index-3580c150.js";import{_ as L,u as N,a as V,b as f,H as A,A as G,B as $,F as j,t as z}from"./FooterComponent-b2d2cabc.js";import{u as U}from"./FormComponent.vue_vue_type_style_index_0_scoped_336c89d5_lang-425db711.js";import{p as J}from"./product-d27d2569.js";import{F as l}from"./FormComponent-7554bdee.js";const u=p=>(H("data-v-c38427b7"),p=p(),T(),p),K={class:"wrapper"},O={class:"form-wrapper"},Q={class:"form-title"},W=u(()=>a("h3",null,"編輯商品",-1)),X=["onSubmit"],Y={class:"form-item"},Z=u(()=>a("label",{for:"category",class:"form-label"},"商品分類",-1)),ee=u(()=>a("span",{class:"form-text"},"※注意商品分類為必填",-1)),te=["value"],ae=["value"],oe=u(()=>a("div",{class:"invalid-text"},"此項目為必選，請選擇商品分類",-1)),se=u(()=>a("div",{class:"valid-text"},h("✓"),-1)),re={__name:"ProductEditPage",setup(p){const y=q(),x=I(),i=N(),e=U(),F=V(),d=J();i.clearErrorMessages(),i.clearSuccessMessages();const b=R(""),k=()=>{b.value="was-validated"};v(()=>{if(F.user.role!=="seller")return x.push("/")}),v(async()=>{const o=await f.GET("/api/v1/products/categories"),{data:s,success:t,message:c}=o.data;return t?d.categories=s.categories:i.setError(c)}),v(async()=>{const o=y.params.product_id,s=await f.GET(`/api/v1/products/${o}`),{data:t,success:c,message:m}=s.data;if(!c)return i.setError(m);d.filterCategories(t.product.Category),e.name=t.product.name,e.price=t.product.price,e.inventory=t.product.inventory_quantity,e.avatar=t.product.avatar,e.description=t.product.description,e.defautCategory=t.product.Category});const E=o=>{const s=o.target.files[0];e.avatar=s},w=async o=>{if(!o.target.checkValidity())return o.preventDefault();const t=z.putTokenToHeader(),c=await f.formDataPUT(`/api/v1/stores/${y.params.product_id}`,{name:e.name,price:e.price,inventory:e.inventory,avatar:e.avatar,description:e.description,category:e.category},t),{success:m,message:C}=c.data;if(!m)return i.setError(C);i.setSuccess(C),x.push("/stores")},P=o=>{const s=o.target.value,t=o.target.id;e.setChangeInput(t,s)};return(o,s)=>(_(),g(S,null,[r(A),a("div",K,[a("div",O,[a("div",Q,[W,r(G)]),a("form",{onSubmit:B(w,["prevent"]),class:M(b.value),novalidate:""},[r(l,{"label-for":"name","label-text":"商品名稱","span-text":"※填寫1-100字商品名稱","input-placeholder":"請輸入商品名稱","input-type":"text","min-length":"1","max-length":"100",inputRequired:"true","invalid-text":"此項目為必填，字數限制1-100",value:n(e).name},null,8,["value"]),r(l,{"label-for":"price","label-text":"售價","span-text":"※注意售價為必填","input-placeholder":"請輸入售價","input-type":"number",inputRequired:"true","invalid-text":"此項目為必填",value:n(e).price},null,8,["value"]),a("div",Y,[Z,ee,a("select",{class:"form-input",onInput:P,name:"category",id:"category",required:""},[a("option",{class:"form-input",value:n(e).defautCategory.id,selected:""},h(n(e).defautCategory.name),9,te),(_(!0),g(S,null,D(n(d).categories,t=>(_(),g("option",{class:"form-input",value:t.id,key:t.id},h(t.name),9,ae))),128))],32),oe,se]),r(l,{"label-for":"inventory","label-text":"存貨量","span-text":"※注意存貨量為必填","input-placeholder":"請輸入存貨量","input-type":"number",inputRequired:"true","invalid-text":"此項目為必填",value:n(e).inventory},null,8,["value"]),r(l,{"label-for":"avatar","label-text":"商品圖片","span-text":"※注意商品圖片為必填","input-placeholder":"",onChange:E,"input-type":"file",inputRequired:"true","invalid-text":"此項目為必填"}),r(l,{"label-for":"description","label-text":"商品描述","span-text":"※注意商品描述為必填","input-placeholder":"請輸入商品描述","input-type":"textarea","min-length":"1","max-length":"400",inputRequired:"true","invalid-text":"此項目為必填",value:n(e).description},null,8,["value"]),a("div",null,[r($,{msg:"更新",backgroundColor:"background-color:#FFBD9D",type:"submit",onClick:k})])],42,X)])]),r(j)],64))}},pe=L(re,[["__scopeId","data-v-c38427b7"]]);export{pe as default};
