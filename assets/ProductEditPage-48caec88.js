import{q as F,u as C,r as k,o as h,b as S,c as w,d as s,e as r,w as E,n as q,j as l,F as P,p as R,h as T}from"./index-23686ead.js";import{_ as B,u as H,t as x,a as d,H as M,A as I,B as D,F as V}from"./FooterComponent-0b396630.js";import{u as A}from"./FormComponent.vue_vue_type_style_index_0_scoped_e1c64aa3_lang-457f4fb9.js";import{F as c}from"./FormComponent-1c539209.js";const G=u=>(R("data-v-4c210556"),u=u(),T(),u),N={class:"wrapper"},$={class:"form-wrapper"},j={class:"form-title"},z=G(()=>r("h3",null,"編輯商品",-1)),U=["onSubmit"],J={__name:"ProductEditPage",setup(u){const m=F(),v=C(),n=H(),e=A();n.clearErrorMessages(),n.clearSuccessMessages();const _=k(""),g=()=>{_.value="was-validated"};h(async()=>{const t=x.putTokenToHeader(),o=await d.GET("/api/v1/users",void 0,t),{success:a,user:i}=o.data;if(!a||i.role!=="seller")return v.push("/")}),h(async()=>{const t=m.params.product_id,o=await d.GET(`/api/v1/products/${t}`),{data:a,success:i,message:p}=o.data;if(!i)return n.setError(p);e.name=a.product.name,e.price=a.product.price,e.inventory=a.product.inventory_quantity,e.avatar=a.product.avatar,e.description=a.product.description});const y=t=>{const o=t.target.files[0];e.avatar=o},b=async t=>{if(!t.target.checkValidity())return t.preventDefault();const a=x.putTokenToHeader(),i=await d.formDataPUT(`/api/v1/stores/${m.params.product_id}`,{name:e.name,price:e.price,inventory:e.inventory,avatar:e.avatar,description:e.description},a),{success:p,message:f}=i.data;if(!p)return n.setError(f);n.setSuccess(f),v.push("/stores")};return(t,o)=>(S(),w(P,null,[s(M),r("div",N,[r("div",$,[r("div",j,[z,s(I)]),r("form",{onSubmit:E(b,["prevent"]),class:q(_.value),novalidate:""},[s(c,{"label-for":"name","label-text":"商品名稱","span-text":"※填寫1-100字商品名稱","input-placeholder":"請輸入商品名稱","input-type":"text","min-length":"1","max-length":"100",inputRequired:"true","invalid-text":"此項目為必填，字數限制1-100",value:l(e).name},null,8,["value"]),s(c,{"label-for":"price","label-text":"售價","span-text":"※注意售價為必填","input-placeholder":"請輸入售價","input-type":"number",inputRequired:"true","invalid-text":"此項目為必填",value:l(e).price},null,8,["value"]),s(c,{"label-for":"inventory","label-text":"存貨量","span-text":"※注意存貨量為必填","input-placeholder":"請輸入存貨量","input-type":"number",inputRequired:"true","invalid-text":"此項目為必填",value:l(e).inventory},null,8,["value"]),s(c,{"label-for":"avatar","label-text":"商品圖片","span-text":"※注意商品圖片為必填","input-placeholder":"",onChange:y,"input-type":"file",inputRequired:"true","invalid-text":"此項目為必填","storeForm.avatar":""}),s(c,{"label-for":"description","label-text":"商品描述","span-text":"※注意商品描述為必填","input-placeholder":"請輸入商品描述","input-type":"textarea","min-length":"1","max-length":"400",inputRequired:"true","invalid-text":"此項目為必填",value:l(e).description},null,8,["value"]),r("div",null,[s(D,{msg:"更新",backgroundColor:"background-color:#FFBD9D",type:"submit",onClick:g})])],42,U)])]),s(V)],64))}},W=B(J,[["__scopeId","data-v-4c210556"]]);export{W as default};
