import{s as R,u as w,r as q,o as C,b as v,c as _,d as s,e as a,w as I,n as B,j as c,t as f,F as S,x as M,p as H,h as T}from"./index-efca3eca.js";import{_ as L,u as N,a as V,b as g,H as A,A as G,B as $,F as j,t as z}from"./FooterComponent-690e1eea.js";import{u as U}from"./FormComponent.vue_vue_type_style_index_0_scoped_336c89d5_lang-27015c05.js";import{p as J}from"./product-edc8630e.js";import{F as u}from"./FormComponent-5e5ca8d9.js";const d=p=>(H("data-v-3316f87b"),p=p(),T(),p),K={class:"wrapper"},O={class:"form-wrapper"},Q={class:"form-title"},W=d(()=>a("h3",null,"編輯商品",-1)),X=["onSubmit"],Y={class:"form-item"},Z=d(()=>a("label",{for:"category",class:"form-label"},"商品分類",-1)),ee=d(()=>a("span",{class:"form-text"},"※注意商品分類為必填",-1)),te=["value"],ae=["value"],oe=d(()=>a("div",{class:"invalid-text"},"此項目為必選，請選擇商品分類",-1)),se=d(()=>a("div",{class:"valid-text"},f("✓"),-1)),re={__name:"ProductEditPage",setup(p){const h=R(),y=w(),l=N(),e=U(),F=V(),m=J();l.clearErrorMessages(),l.clearSuccessMessages();const x=q(""),k=()=>{x.value="was-validated"};C(()=>{if(F.user.role!=="seller")return y.push("/")}),C(async()=>{const o=h.params.product_id,[i,r]=await Promise.all([g.GET("/api/v1/products/categories"),g.GET(`/api/v1/products/${o}`)]),n=i.data,t=r.data;if(!n.success||!t.success)return l.setError(n.message||t.message);m.categories=n.data.categories,m.filterCategories(t.data.product.Category),e.name=t.data.product.name,e.price=t.data.product.price,e.inventory=t.data.product.inventory_quantity,e.avatar=t.data.product.avatar,e.description=t.data.product.description,e.defautCategory=t.data.product.Category,e.category=t.data.product.Category.id});const D=o=>{const i=o.target.files[0];e.avatar=i},E=async o=>{if(!o.target.checkValidity())return o.preventDefault();const r=z.putTokenToHeader(),n=await g.formDataPUT(`/api/v1/stores/${h.params.product_id}`,{name:e.name,price:e.price,inventory:e.inventory,avatar:e.avatar,description:e.description,category:e.category},r),{success:t,message:b}=n.data;if(!t)return l.setError(b);l.setSuccess(b),y.push("/stores")},P=o=>{const i=o.target.value,r=o.target.id;e.setChangeInput(r,i)};return(o,i)=>{var r,n;return v(),_(S,null,[s(A),a("div",K,[a("div",O,[a("div",Q,[W,s(G)]),a("form",{onSubmit:I(E,["prevent"]),class:B(x.value),novalidate:""},[s(u,{"label-for":"name","label-text":"商品名稱","span-text":"※填寫1-100字商品名稱","input-placeholder":"請輸入商品名稱","input-type":"text","min-length":"1","max-length":"100",inputRequired:"true","invalid-text":"此項目為必填，字數限制1-100",value:c(e).name},null,8,["value"]),s(u,{"label-for":"price","label-text":"售價","span-text":"※注意售價為必填","input-placeholder":"請輸入售價","input-type":"number",inputRequired:"true","invalid-text":"此項目為必填",value:c(e).price},null,8,["value"]),a("div",Y,[Z,ee,a("select",{class:"form-input",onInput:P,name:"category",id:"category",required:""},[a("option",{class:"form-input",value:(r=c(e).defautCategory)==null?void 0:r.id,selected:""},f((n=c(e).defautCategory)==null?void 0:n.name),9,te),(v(!0),_(S,null,M(c(m).categories,t=>(v(),_("option",{class:"form-input",value:t.id,key:t.id},f(t.name),9,ae))),128))],32),oe,se]),s(u,{"label-for":"inventory","label-text":"存貨量","span-text":"※注意存貨量為必填","input-placeholder":"請輸入存貨量","input-type":"number",inputRequired:"true","invalid-text":"此項目為必填",value:c(e).inventory},null,8,["value"]),s(u,{"label-for":"avatar","label-text":"商品圖片","span-text":"※注意商品圖片為必填","input-placeholder":"",onChange:D,"input-type":"file",inputRequired:"true","invalid-text":"此項目為必填"}),s(u,{"label-for":"description","label-text":"商品描述","span-text":"※注意商品描述為必填","input-placeholder":"請輸入商品描述","input-type":"textarea","min-length":"1","max-length":"400",inputRequired:"true","invalid-text":"此項目為必填",value:c(e).description},null,8,["value"]),a("div",null,[s($,{msg:"更新",backgroundColor:"background-color:#FFBD9D",type:"submit",onClick:k})])],42,X)])]),s(j)],64)}}},de=L(re,[["__scopeId","data-v-3316f87b"]]);export{de as default};
