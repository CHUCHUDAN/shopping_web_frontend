import{b as g,c as y,x as E,j as v,F as $,e as s,l as x,t as _,f as P,k as H,u as A,o as C,d as l}from"./index-917c549d.js";import{_ as b,u as T,t as k,b as m,a as F,H as B,A as M,B as S,F as q}from"./FooterComponent-537da39a.js";import{p as w}from"./product-6bcecdb4.js";const L={class:"data-wrapper"},j=["onClick"],N={class:"product-data"},O={class:"product-price"},V={class:"product-num"},Q={class:"userData-wrapper"},z={class:"product-name"},G={class:"shopcar-num"},I={class:"shopcar-price"},R={class:"use-wrapper"},J={class:"control-button"},K=["onClick"],U=["onClick"],W={class:"delete-button"},X=["onClick"],Y={__name:"ShopcarProduct",setup(D){const i=w(),c=T(),a=async p=>{window.scrollTo({top:0,behavior:"smooth"});const h=k.putTokenToHeader(),t=await m.DELETE(`/api/v1/shopcars/${p}`,void 0,h),{success:o,message:e}=t.data;return o?(i.deleteProducts(p),i.totalAmountCount(),c.setSuccess(e)):c.setError(e)},f=p=>{H.push(`/product/${p}`)};return(p,h)=>(g(!0),y($,null,E(v(i).products,t=>{var o,e,u,r,d;return g(),y("div",{class:"product-wrapper",key:t.id},[s("div",L,[s("div",{class:"product-pic",style:x(`background-image: url('${(o=t.Product)==null?void 0:o.avatar}')`),onClick:n=>f(t.product_id)},null,12,j),s("div",N,[s("div",O,"售價: $ "+_((e=t.Product)==null?void 0:e.price),1),s("div",V,"存貨量: "+_((u=t.Product)==null?void 0:u.inventory_quantity),1)])]),s("div",Q,[s("div",z,"商品名稱: "+_((r=t.Product)==null?void 0:r.name),1),s("div",G,[P("購買數量: "),s("span",null,_(t.quantity),1)]),s("div",I,[P("累加金額: "),s("span",null,"$ "+_(t.quantity*((d=t.Product)==null?void 0:d.price)),1)])]),s("div",R,[s("div",J,[s("i",{class:"fa-solid fa-circle-plus plus",onClick:n=>v(i).setProductQuantity("plus",t.id)},null,8,K),s("i",{class:"fa-solid fa-circle-minus minus",onClick:n=>v(i).setProductQuantity("minus",t.id)},null,8,U)]),s("div",W,[s("i",{class:"fa-solid fa-trash delete","product-id":"item.product_id",onClick:n=>a(t.product_id)},null,8,X)])])])}),128))}},Z=b(Y,[["__scopeId","data-v-31185e5a"]]);const ss={class:"shopcar-wrapper"},ts={class:"checkout-wrapper"},os={class:"total-amount"},es={class:"checkout-button"},cs={class:"updated-button"},as={class:"products-wrapper"},rs={__name:"ShopcarPage",setup(D){const i=A(),c=T(),a=w(),f=F();c.clearErrorMessages(),c.clearSuccessMessages(),C(()=>{if(f.user.role!=="buyer")return i.push("/")}),C(async()=>{const t=k.putTokenToHeader(),o=await m.GET("/api/v1/shopcars",void 0,t),{success:e,message:u,data:r}=o.data;return e?(a.totalAmount=r.totalAmount,a.setProduct(r.shopcars)):c.setError(u)});const p=async()=>{const t=a.products,o=Object.fromEntries(t.map(n=>[n.product_id,n.quantity])),e=k.putTokenToHeader(),u=await m.PATCH("/api/v1/shopcars",o,e),{success:r,message:d}=u.data;return r?c.setSuccess(d):c.setError(d)},h=async()=>{const t=a.products,o=Object.fromEntries(t.map(n=>[n.product_id,n.quantity])),e=k.putTokenToHeader(),u=await m.POST("/api/v1/shopcars/checkout",o,e),{success:r,message:d}=u.data;return r?(a.productCheckout(),a.totalAmount=0,c.setSuccess(d)):c.setError(d)};return(t,o)=>(g(),y($,null,[l(B),s("div",ss,[l(M),s("div",ts,[s("div",os,"總金額: "+_(v(a).totalAmount),1),s("div",es,[l(S,{msg:"結帳",backgroundColor:"background-color:#FFBD9D",onClick:h})]),s("div",cs,[l(S,{msg:"更新",backgroundColor:"background-color:#FFBD9D",onClick:p})])]),s("div",as,[l(Z)])]),l(q)],64))}},is=b(rs,[["__scopeId","data-v-df19441e"]]);export{is as default};
